<?php
/**
 *
 * @author Johan Steyn <jsteyn@quint.co.uk>
 * @link https://api.appcheck-ng.com/
 * Date: 2020/03/05
 * Time: 10:00
 */
namespace Inqbate\Appcheck;


trait VulnerabilityTrait
{

    /**
     * Return all vulnerabilities
     * @return object|null
     * @throws Exceptions\RecordNotFoundException
     */
    public function vulnerabilities()
    {
        return $this->setRequestUri($this->getRequestUri() . '/vulnerabilities')->get();
    }

    /**
     * Fetch information about a vulnerability
     * @param String $id
     * @return Vulnerability
     */
    public function vulnerability(String $id): Vulnerability
    {
        $vulnerability =  new Vulnerability($this->connection);

        if($id != null) {
            return $vulnerability->find($id);
        }
        return $vulnerability;
    }
}
